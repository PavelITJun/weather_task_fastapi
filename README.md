# Weather Task 4

Этот проект представляет собой веб-приложение для получения прогноза погоды на ближайшие 3 часа для указанного города. Приложение написано на FastAPI и использует PostgreSQL в качестве СУБД. Приложение обёрнуто в Docker и имеет фикстуры и тесты для почти всех эндпоинтов с использованием pytest.

## Обзор

- Реализовано получение температуры на ближайшие 3 часа в удобном для людей формате при вводе города.
- Используется FastAPI в качестве фреймворка и PostgreSQL в качестве СУБД.
- Приложение обёрнуто в Docker.
- Написаны фикстуры и тесты (pytest) для большинства эндпоинтов.
- Реализовано автодополнение при вводе города с использованием данных о городах всего мира, хранящихся в базе данных.
- При повторном посещении сайта предлагается посмотреть температуру в последнем запрашиваемом городе с текущего IP-адреса. IP-адреса также хранятся в базе данных.
- История поиска каждого устройства сохраняется в базе данных. Есть API для просмотра количества запросов к каждому городу для конкретного пользователя.

## Установка

1. Клонируйте репозиторий:

   ```bash
   git clone https://github.com/PavelITJun/weather_task_fastapi.git
   cd repository
   ```

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

## Запуск с помощью Docker

1. Убедитесь, что у вас установлены Docker и Docker Compose.
2. Создайте файл `.env_non_dev` в корне проекта и добавьте туда все необходимые переменные окружения.
3. Поднимите контейнеры с помощью Docker Compose:
   ```bash
   docker-compose up
   ```
4. Приложение будет доступно по адресу `http://localhost:7777`.

## Руководство по использованию

1. Перейдите на `http://localhost:7777`.
2. По этому URL будет доступен ввод города для получения прогноза погоды. Если вы уже посещали наш сайт, будет показана подсказка с последним запросом по городу.
3. По `http://localhost:7777/get_history/{id}`, где `{id}` — идентификатор пользователя в базе данных, будет доступна информация о том, какие города и сколько раз искал конкретный пользователь. Этот эндпоинт должен быть доступен только для администраторов в реальном проекте.

## Переменные окружения

Создайте файл `.env_non_dev` в корне проекта и добавьте туда следующие переменные окружения:

```env
DATABASE_URL=postgres://user:password@db:5432/dbname
SECRET_KEY=your_secret_key
```
